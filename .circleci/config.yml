version: 2.1

orbs:
  slack: circleci/slack@4.2.0

jobs:
  build:
    docker:
      - image: circleci/node:14

    steps:
      - checkout

      # Install project dependencies
      - run:
          name: Install Dependencies
          command: npm install

notify-slack:
  docker:
    - image: cimg/base:2021.10

  steps:
    - run:
        name: Notify Slack
        command: |
          echo '{
            "type": "plain_text",
            "text": "This is Ethan Tanner submitting the Slack assignment",
            "emoji": true
          }' > slack_message.json

    - slack/notify:
        custom: cat slack_message.json
        event: always

workflows:
  send-notification:
    jobs:
      - notify-slack:
          context: slack-

  build-and-notify:
    jobs:
      - build
      - notify-slack